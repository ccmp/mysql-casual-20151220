# Usage:
#  ansible-playbook -i ./hosts ./main.yml -vv
#

- hosts: cli
  remote_user: root

  tasks:

  - get_url: url={{ item }} dest=/root/ mode=0440
    with_items:
#      - http://dev.mysql.com/get/mysql-apt-config_0.5.3-1_all.deb
      - http://dev.mysql.com/get/mysql-apt-config_0.8.10-1_all.deb

  - apt: update_cache=yes

  - apt: deb=/root/{{ item }} state=installed 
    with_items:
#      - mysql-apt-config_0.5.3-1_all.deb
      - mysql-apt-config_0.8.10-1_all.deb
    environment:
      DEBIAN_FRONTEND: "noninteractive"

  - copy: src=./files/{{ item.name }} dest={{ item.name }} mode={{ item.mode }}
    with_items:
      - { name: '/etc/apt/sources.list.d/mysql.list', mode: '0644' }
      - { name: '/etc/apt/apt.conf', mode: '0644' }

  - apt: pkg={{ item }} state=present update_cache=yes
    with_items:
      - mysql-client
